---
title: "Lab3"
output: html_document
date: "2022-11-26"
---

# Lab3

```{r}

TLN <- "020"
```

## Part I: Markov Chain

```{r}
m <- 1000

estimate_probability <- Vectorize(function (n) {
  sample_data <- apply(
    replicate(m, sample(0:9, n, replace = T)), 2,
    function(x) grepl(TLN, paste(x, collapse = "")))
  return (length(sample_data[sample_data == TRUE]) / length(sample_data))
})

x <- seq(100, 1000, by = 100)
plot(
  x,
  estimate_probability(x), col ="blue", lwd = 3)

```

$$
P=\begin{bmatrix}
0.9 & 0.1 & 0 & 0\\
0.8 & 0.1 & 0.1 & 0\\
0.9 & 0 & 0 & 0.1\\
0.8 & 0.1 & 0.1 & 0\\
\end{bmatrix}
$$

```{r}
# Transition matrix
P = matrix(c(
  0.9, 0.1, 0, 0,
  0.8, 0.1, 0.1, 0,
  0.9, 0, 0, 0.1,
  0.8, 0.1, 0.1, 0), nrow=4, byrow=T)

left_eigenvector <- eigen(t(P))$vectors[,1]
sapply(left_eigenvector / sum(left_eigenvector), Re)

# Alternative method
# P %*% P %*% P
```
